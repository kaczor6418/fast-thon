name: Cache firebase emulators
on: workflow_call
jobs:
  cache_firebase_emulators:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout 🏗️
        uses: actions/checkout@v3

      - name: Get Library Versions For Binary Caching 🧬
        id: cache-settings
        run: |
          echo "::set-output name=firebase-tools::$(yarn list -s --depth=0 --pattern firebase-tools | tail -n 1 | sed 's/.*@//g')"
          echo "::set-output name=firebase-tools::$(npm list -s --depth=0 | grep firebase-tools | tail -n 1 | sed 's/.*@//g')"

      - name: Cache Firebase Emulator Binaries 🔥
        uses: actions/cache@v2.1.2
        with:
          path: ~/.cache/firebase/emulators
          key: ${{ runner.os }}-firebase-${{ steps.cache-settings.outputs.firebase-tools }}
